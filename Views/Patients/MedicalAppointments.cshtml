@{
    ViewData["Title"] = "Appointments";
    var upcomingAppointments = ViewBag.UpcomingAppointments as List<AppointAid.Models.Appointment> ?? new List<AppointAid.Models.Appointment>();
    var previousAppointments = ViewBag.PreviousAppointments as List<AppointAid.Models.Appointment> ?? new List<AppointAid.Models.Appointment>();
}

<div class="container mt-4">
    <h1 class="text-center">Appointments</h1>

    <!-- Upcoming Appointments -->
    <div class="card mt-4">
        <div class="card-header bg-primary text-white">
            <h4 class="m-0">Upcoming Appointments</h4>
        </div>
        <div class="card-body">
            @if (upcomingAppointments.Any())
            {
                @foreach (var appointment in upcomingAppointments)
                {
                    <div class="card mb-3">
                        <div class="card-body">
                            <p><strong>Doctor:</strong> Dr. @appointment.Doctor?.FullName ?? "Unknown"</p>
                            <p><strong>Medical Center:</strong> @appointment.Doctor?.Sector?.MedicalCenter?.MedicalCenterName ?? "Unknown"</p>
                            <p><strong>Sector:</strong> @appointment.Doctor?.Sector?.Name ?? "Unknown"</p>
                            <p><strong>Date:</strong> @appointment.TimeSlot?.StartTime.ToString("MMMM dd, yyyy h:mm tt") ?? "Not Scheduled"</p>
                            <p><strong>Status:</strong> @appointment.Status</p>
                            <div class="d-flex justify-content-between">
                                <button class="btn btn-primary btn-sm">Get Location</button>
                                <button class="btn btn-warning btn-sm">Reschedule</button>
                                <button class="btn btn-danger btn-sm">Cancel</button>
                            </div>
                        </div>
                    </div>
                }
            }
            else
            {
                <p>No upcoming appointments.</p>
            }
        </div>
        <div class="card-footer text-center">
            <a class="btn btn-primary" asp-controller="Patients" asp-action="Symptoms">
                <i class="bi bi-calendar-plus"></i> Set New Appointment
            </a>
        </div>
    </div>

    <!-- Previous Appointments -->
    <div class="card mt-4">
        <div class="card-header bg-secondary text-white">
            <h4 class="m-0">Previous Appointments</h4>
        </div>
        <div class="card-body">
            @if (previousAppointments.Any())
            {
                @foreach (var appointment in previousAppointments)
                {
                    <div class="card mb-3">
                        <div class="card-body">
                            <p><strong>Doctor:</strong> Dr. @appointment.Doctor?.FullName ?? "Unknown"</p>
                            <p><strong>Medical Center:</strong> @appointment.Doctor?.Sector?.MedicalCenter?.MedicalCenterName ?? "Unknown"</p>
                            <p><strong>Sector:</strong> @appointment.Doctor?.Sector?.Name ?? "Unknown"</p>
                            <p><strong>Date:</strong> @appointment.TimeSlot?.StartTime.ToString("MMMM dd, yyyy h:mm tt") ?? "Not Scheduled"</p>
                            <p><strong>Status:</strong> @appointment.Status</p>
                            @if (appointment.Status == "Completed")
                            {
                                <button class="btn btn-info btn-sm">View Medical Report</button>
                            }
                        </div>
                    </div>
                }
            }
            else
            {
                <p>No previous appointments.</p>
            }
        </div>
        <div class="card-footer text-center">
            <button class="btn btn-secondary">More</button>
        </div>
    </div>
</div>